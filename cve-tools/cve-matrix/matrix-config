#!/usr/bin/python
from __future__                 import print_function

import os
import sys
import textwrap

# Add ../libs to the Python search path
sys.path.append(os.path.realpath(
    os.path.join(os.path.dirname(__file__), os.pardir, os.pardir, 'libs')))

from ktl.kernel_series          import KernelSeries

kernel_series = KernelSeries()

# Commands: primary
cmd = sys.argv[1]

if cmd == 'primary':
    source_packages = {}
    for series in sorted(kernel_series.series, key=KernelSeries.key_series_name):
        if not series.opening_ready('repositories'):
            continue
        if not series.supported and not series.development:
            continue
        for source in sorted(series.sources, key=lambda x: x.name):
            if not source.supported:
                continue

            for package in source.packages:
                if package.type is None:
                    source_packages[package.name] = True

    print(textwrap.dedent("""
        source_package_list()
        {{
            RET="{sources}";
        }};
        """).strip().format(sources=" ".join(sorted(source_packages.keys()))))


